@startuml spec-03-task-flow
title 子计划3: 核心系统实现 - 任务执行流程图

start

partition "3.1 完整战斗系统" {
  :扩展config.js配置;
  note right: 连击/击退/无敌帧参数
  :实现连击系统;
  note right: ComboSystem.js
  :实现击退效果;
  :实现无敌帧机制;
  :增强攻击特效;
}

partition "3.6 伤害和数值系统" {
  :实现伤害计算模块;
  note right: DamageSystem.js
  :实现暴击系统;
  :实现伤害数字显示;
  note right: DamageNumber.js
  :实现属性叠加计算;
}

partition "3.2 技能系统" {
  :实现技能数据结构;
  note right: SkillManager.js
  :实现技能冷却系统;
  :实现剑气横扫;
  note right: 范围攻击
  :实现瞬步斩;
  note right: 突进攻击
  :实现护体真气;
  note right: 防御/反击
  :实现剑域;
  note right: 终极技能
  :实现技能特效;
}

partition "3.3 敌人AI系统" {
  :重构Enemy基类;
  :实现敌人类型;
  note right
    飘影(追踪)
    妖狼(冲锋)
    蛇妖(远程)
    怨魂(分裂)
  end note
  :实现行为状态机;
  note right: StateMachine.js
  :实现精英敌人;
  :实现Boss敌人;
  :实现死亡特效;
}

partition "3.5 无尽模式系统" {
  :实现波次管理器;
  note right: WaveManager.js
  :实现波次配置;
  :实现难度递增;
  :实现波次间隔;
  :实现波次预告UI;
}

partition "3.4 Roguelike系统" {
  :实现强化道具数据;
  note right: Upgrades.js
  :实现强化池和稀有度;
  :实现选择界面;
  note right: UpgradeSelectScene.js
  :实现强化效果应用;
  :实现15-20种强化;
}

partition "3.7 游戏状态管理" {
  :实现暂停/继续;
  :实现游戏结束判定;
  :实现结算统计;
  note right: GameOverScene.js
  :实现重新开始;
}

:集成测试;
:性能优化;

stop
@enduml
