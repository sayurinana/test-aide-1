# 子计划 4：普攻类型扩展 + 强化系统

## 目标

实现剩余 4 种普攻类型，设计完整的普攻强化系统，并进行平衡性调整。

## 具体步骤

### 普攻类型实现

1. 实现 `src/attacks/OrbAttack.js` (追踪法球)：
   - 发射自动追踪最近敌人的法球
   - 强化：法球数量、追踪范围、伤害、持续时间、穿透

2. 实现 `src/attacks/WaveAttack.js` (冲击波)：
   - 向前方发射扩散的冲击波
   - 强化：波动范围、伤害、减速效果、波数、扩散角度

3. 实现 `src/attacks/LightningAttack.js` (闪电链)：
   - 对最近敌人释放闪电，可弹射到其他敌人
   - 强化：弹射次数、弹射范围、伤害衰减、麻痹效果

4. 实现 `src/attacks/SummonAttack.js` (召唤物)：
   - 召唤自动战斗的分身/傀儡
   - 强化：召唤数量、召唤物属性、持续时间、攻击方式

### 普攻强化系统

1. 重构 `src/data/BuffData.js`：
   - 添加 `ATTACK_BUFFS` 分类
   - 每种普攻 5-8 个专属强化
   - 设计稀有度分布

2. 强化数据结构：
   ```javascript
   {
     id: 'arrow_scatter',
     name: '散射箭矢',
     description: '射箭时额外发射 +1 支箭',
     attackType: 'arrow',
     rarity: 'rare',
     effect: { scatterCount: 1 },
     maxStack: 5
   }
   ```

3. 修改 `BuffSelectionScene.js`：
   - 区分「通用强化」和「普攻强化」
   - 普攻强化只对已装备的普攻类型生效
   - UI 展示普攻图标标识

### 新普攻获取机制

1. 修改强化选择逻辑：
   - 一定概率出现「新普攻」卡片
   - 选择后获得该普攻类型
   - 已拥有的普攻不再出现

2. 设计获取概率：
   - 普通强化：70%
   - 普攻强化：20%
   - 新普攻：10%

### 平衡性调整

1. 设计基础数值：
   | 普攻 | 基础伤害 | 冷却 | 特点 |
   |------|----------|------|------|
   | 射箭 | 8 | 0.5s | 远程单体 |
   | 挥砍 | 12 | 0.8s | 近战范围 |
   | 法球 | 6 | 1.0s | 自动追踪 |
   | 冲击波 | 10 | 1.2s | 范围减速 |
   | 闪电链 | 7 | 0.8s | 多目标 |
   | 召唤物 | 5/只 | 5.0s | 持续输出 |

2. 测试并调整：
   - 使用测试关卡验证各普攻手感
   - 调整伤害/冷却平衡
   - 确保各 Build 路线可行

### 视觉效果

1. 为每种普攻设计特效：
   - 射箭：箭矢飞行轨迹
   - 挥砍：弧形挥砍效果
   - 法球：追踪轨迹 + 命中爆炸
   - 冲击波：扩散波纹
   - 闪电链：电弧连线
   - 召唤物：召唤特效 + 分身外观

2. 更新 `VFXManager.js` 支持新特效

## 验证标准

- [ ] 6 种普攻全部可正常使用
- [ ] 每种普攻至少有 5 个专属强化
- [ ] 可在游戏中获得新普攻类型
- [ ] 多普攻组合流畅，无性能问题
- [ ] 各普攻类型有明显区分度和特色
- [ ] 游戏平衡性：能正常推进波次

## 依赖

- **前置**：子计划 3（普攻基础架构）
- **后续**：无
